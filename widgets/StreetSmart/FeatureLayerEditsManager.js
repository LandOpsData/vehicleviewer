function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}define(['dojo/on','dojo/dom','dojo/text!./EditableLayers.html','dojo/dom-construct','dijit/Tooltip','./FeatureLayerManager'],function(on,dom,EditableLayers,domConstruct,Tooltip,FeatureLayerManager){'use strict';return function(){function FeatureLayerEditManager(_ref){var map=_ref.map,wkid=_ref.wkid,StreetSmartApi=_ref.StreetSmartApi,addEventListener=_ref.addEventListener,panoramaViewerDiv=_ref.panoramaViewerDiv,nls=_ref.nls;_classCallCheck(this,FeatureLayerEditManager);this.map=map;this.wkid=wkid;this.StreetSmartApi=StreetSmartApi;this.addEventListener=addEventListener;this.panoramaViewerDiv=panoramaViewerDiv;this.nls=nls;this._saveMeasurements=false;this.featureLayerManager=new FeatureLayerManager({map:this.map,wkid:this.wkid,StreetSmartApi:this.StreetSmartApi})}FeatureLayerEditManager.prototype._displayEditableLayers=function _displayEditableLayers(){var _this=this;var layerDivs=this._filterEditableLayers();var nav=this.panoramaViewerDiv.querySelector('.cmtMousePosition');var overlayHtml=EditableLayers;var overlayDom=domConstruct.toDom(overlayHtml);domConstruct.place(overlayDom,nav,'after');var layerTableId=dom.byId('layersTable');_.each(layerDivs,function(layer){domConstruct.place(layer.layerDiv,layerTableId);_this.addEventListener(dom.byId(layer.id),'click',function(){return _this._SelectLayerToSave(layer)})})};FeatureLayerEditManager.prototype._filterEditableLayers=function _filterEditableLayers(){var mapLayers=_.values(this.map._layers);var featureLayers=_.filter(mapLayers,function(l){return l.type==='Feature Layer'});var editableLayers=_.filter(featureLayers,function(l){return l.isEditable()===true});var displayLayerNames=[];_.each(editableLayers,function(mapLayer){var id='editable-layer-'+mapLayer.name;var layerCheckBox='<tr><td><div class="form-group" id="'+id+'">'+'<div class="checklist_location">'+'<div class="checkbox">'+'<label title=""><input type="checkbox" value="off">'+('<span>'+mapLayer.name+'</span>')+'</label>'+'</div>'+'</div>'+'</div></td></tr>';var layerHtml=domConstruct.toDom(layerCheckBox);var layerNameUrl={url:mapLayer.url,name:mapLayer.name,layerDiv:layerHtml,id:id};displayLayerNames.push(layerNameUrl)});return displayLayerNames};FeatureLayerEditManager.prototype._SelectLayerToSave=function _SelectLayerToSave(layer){var _this2=this;if(dom.byId('saveMeasurementsBtn')!==null){domConstruct.destroy('saveMeasurementsBtn');this._saveMeasurements=false}if(this._saveMeasurements===false){var nav=this.panoramaViewerDiv.querySelector('.navbar .navbar-right .nav');var exampleButton=nav.querySelector('.btn');// Draw the actual button in the same style as the other buttons.
var saveMeasurementsButton=dojo.create('button',{id:'saveMeasurementsBtn',class:exampleButton.className});nav.appendChild(saveMeasurementsButton);var toolTipMsg=this.nls.tipSaveMeasurement;new Tooltip({connectId:saveMeasurementsButton,label:toolTipMsg,position:['above']});this._saveMeasurements=true;// this._featureLayerManager = new FeatureLayerManager({
//     map: this.map,
//     wkid: this.wkid,
//     StreetSmartApi: this.StreetSmartApi
// });
this.addEventListener(dom.byId('saveMeasurementsBtn'),'click',function(){return _this2.featureLayerManager._saveMeasurementsToLayer(layer)})}};return FeatureLayerEditManager}()});